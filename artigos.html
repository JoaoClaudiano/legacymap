<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Artigos & Guias - LegacyMap</title>
    <meta name="description" content="Biblioteca completa de artigos sobre análise de código, arquitetura de software, refatoração e boas práticas de desenvolvimento.">
    
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* (MANTENHA TODOS OS ESTILOS CSS QUE VOCÊ JÁ TEM) */
        /* Os estilos permanecem os mesmos do código anterior */
    </style>
</head>
<body class="dark-theme">
    <!-- (MANTENHA TODO O HTML DO HEADER E FOOTER) -->
    <!-- O HTML permanece igual -->

    <!-- Scripts ATUALIZADOS -->
    <script>
        // =============================================
        // SISTEMA DE DETECÇÃO AUTOMÁTICA DE ARTIGOS
        // =============================================
        
        // Banco de dados PRINCIPAL (fallback se o auto-detect falhar)
        const ARTICLES_FALLBACK = [
            {
                file: "codecartographer-vs-ferramentas-empresariais.html",
                title: "CodeCartographer vs. Ferramentas Empresariais",
                excerpt: "SonarQube, NDepend, Structure101... Veja quando uma solução focada como a nossa é a escolha certa.",
                category: "Comparativos & Análise",
                date: "5 Fev, 2026",
                readTime: "8 min"
            },
            // ... outros artigos de fallback
        ];
        
        // Mapeamento inteligente de nomes de arquivo para metadados
        const ARTICLE_METADATA_MAP = {
            // Padrão: "nome-do-arquivo.html": { metadados }
            "3-metricas-codigo-desenvolvedor-junior.html": {
                title: "3 Métricas de Código que Todo Desenvolvedor Júnior Deveria Monitorar",
                excerpt: "Métricas simples para iniciantes começarem a monitorar a saúde do código antes de mergulhar em padrões complexos de arquitetura.",
                category: "Para Iniciantes",
                readTime: "6 min"
            },
            "5-problemas-arquitetura-revela.html": {
                title: "5 Problemas de Arquitetura que um Mapa de Dependências Revela",
                excerpt: "Descubra padrões comuns como 'God Objects', ciclos de dependência e módulos órfãos.",
                category: "Análise & Diagnóstico",
                readTime: "7 min"
            },
            "analise-temporal-evolucao-arquitetura.html": {
                title: "Análise Temporal: Como a Arquitetura Evolui ao Longo do Tempo",
                excerpt: "Métodos para analisar a evolução arquitetural através de commits e identificar degradação.",
                category: "Análise Avançada",
                readTime: "11 min"
            },
            "arquitetura-padroes.html": {
                title: "Padrões de Arquitetura Moderna",
                excerpt: "Análise comparativa dos principais padrões arquiteturais e quando cada um é adequado.",
                category: "Arquitetura & Padrões",
                readTime: "10 min"
            },
            "automatizando-analise-arquitetural-ci-cd.html": {
                title: "Automatizando a Análise Arquitetural no CI/CD",
                excerpt: "Guia para integrar análise de dependências no pipeline e prevenir degradação arquitetural.",
                category: "DevOps & Automação",
                readTime: "12 min"
            },
            "avaliar-repositorio.html": {
                title: "Workshop: Avalie Qualquer Repositório GitHub em 1 Hora",
                excerpt: "Siga este workshop para gerar um relatório completo sobre saúde arquitetural.",
                category: "Tutorial Prático",
                readTime: "9 min"
            },
            "caso-refatoracao-40porcento-divida.html": {
                title: "Caso Real: Reduzimos 40% da Dívida Técnica em 3 Meses",
                excerpt: "Análise de um projeto onde identificamos pontos críticos de acoplamento.",
                category: "Caso de Estudo",
                readTime: "10 min"
            },
            "code-smells-arquiteturais.html": {
                title: "Code Smells Arquiteturais: Quando as Métricas Mentem",
                excerpt: "Nem todo módulo altamente acoplado é um problema. Descubra quando violar boas práticas é correto.",
                category: "Opinião & Análise",
                readTime: "10 min"
            },
            "codecartographer-vs-ferramentas-empresariais.html": {
                title: "CodeCartographer vs. Ferramentas Empresariais",
                excerpt: "SonarQube, NDepend, Structure101... Veja quando uma solução focada é a escolha certa.",
                category: "Comparativos & Análise",
                readTime: "8 min"
            },
            "como-identificar-dependencias-circulares.html": {
                title: "Como Identificar e Corrigir Dependências Circulares",
                excerpt: "Aprenda a detectar e resolver problemas comuns em código legado usando análise visual.",
                category: "Tutorial Prático",
                readTime: "8 min"
            },
            "ferramenta-visual-vs-analise-estatica.html": {
                title: "Ferramenta Visual vs. Análise Estática",
                excerpt: "Comparativo das abordagens para análise de código e quando cada uma é mais eficaz.",
                category: "Ferramentas & Comparativos",
                readTime: "5 min"
            },
            "futuro-analise-codigo.html": {
                title: "O Futuro da Análise de Código com IA",
                excerpt: "De visualizações estáticas para assistentes de IA que preveem pontos de falha.",
                category: "Tendências & Futuro",
                readTime: "11 min"
            },
            "gestao-divida-tecnica-metricas.html": {
                title: "Gestão de Dívida Técnica para Líderes",
                excerpt: "Como traduzir complexidade ciclomática em argumentos que stakeholders entendem.",
                category: "Gestão & Liderança",
                readTime: "12 min"
            },
            "mapa-dependencias-radar-desenvolvedor.html": {
                title: "Mapa de Dependências: O Radar do Desenvolvedor",
                excerpt: "Entenda como a visualização de dependências revela a saúde estrutural do software.",
                category: "Arquitetura & Conceitos",
                readTime: "6 min"
            },
            "planejando-refatoracao-mapa-ordem.html": {
                title: "Planejando uma Grande Refatoração",
                excerpt: "Estratégia para priorizar refatorações baseada em análise de risco e impacto.",
                category: "Gestão & Estratégia",
                readTime: "9 min"
            }
        };
        
        // Função para detectar automaticamente os arquivos da pasta
        async function detectArticles() {
            try {
                // Lista de arquivos que sabemos que existem
                const knownArticles = Object.keys(ARTICLE_METADATA_MAP);
                
                // Verificar quais arquivos realmente existem
                const existingArticles = [];
                
                for (const fileName of knownArticles) {
                    try {
                        // Tenta carregar o arquivo para ver se existe
                        const response = await fetch(`artigos/${fileName}`, { method: 'HEAD' });
                        if (response.ok) {
                            existingArticles.push(fileName);
                        }
                    } catch (error) {
                        console.log(`Arquivo não encontrado: ${fileName}`);
                    }
                }
                
                console.log(`✅ Detectados ${existingArticles.length} artigos na pasta 'artigos/'`);
                return existingArticles;
                
            } catch (error) {
                console.error('Erro ao detectar artigos:', error);
                return Object.keys(ARTICLE_METADATA_MAP); // Fallback para todos conhecidos
            }
        }
        
        // Função para gerar data automática baseada no nome do arquivo
        function generateAutoDate(fileName) {
            const today = new Date();
            const monthNames = ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", 
                               "Jul", "Ago", "Set", "Out", "Nov", "Dez"];
            
            // Se for um arquivo novo (não está no mapa), usa data atual
            if (!ARTICLE_METADATA_MAP[fileName]) {
                return `${today.getDate()} ${monthNames[today.getMonth()]}, ${today.getFullYear()}`;
            }
            
            // Para arquivos conhecidos, usa uma data fixa (pode personalizar)
            const articleDates = {
                "3-metricas-codigo-desenvolvedor-junior.html": "30 Jan, 2026",
                "5-problemas-arquitetura-revela.html": "15 Jan, 2026",
                // Adicione datas específicas para outros arquivos se quiser
            };
            
            return articleDates[fileName] || "1 Jan, 2026";
        }
        
        // Função para gerar título a partir do nome do arquivo
        function generateAutoTitle(fileName) {
            // Remove .html e substitui hífens por espaços
            const nameWithoutExt = fileName.replace('.html', '');
            const words = nameWithoutExt.split('-');
            
            // Capitaliza cada palavra
            const title = words.map(word => {
                // Mantém siglas em maiúsculo
                if (word === 'ci' || word === 'cd' || word === 'ia') {
                    return word.toUpperCase();
                }
                return word.charAt(0).toUpperCase() + word.slice(1);
            }).join(' ');
            
            return title;
        }
        
        // Função para gerar categoria automática
        function generateAutoCategory(fileName) {
            const lowerName = fileName.toLowerCase();
            
            if (lowerName.includes('tutorial') || lowerName.includes('workshop') || lowerName.includes('como')) {
                return "Tutorial Prático";
            } else if (lowerName.includes('analise') || lowerName.includes('problema')) {
                return "Análise & Diagnóstico";
            } else if (lowerName.includes('arquitetura') || lowerName.includes('padrao')) {
                return "Arquitetura & Padrões";
            } else if (lowerName.includes('devops') || lowerName.includes('ci') || lowerName.includes('cd')) {
                return "DevOps & Automação";
            } else if (lowerName.includes('caso') || lowerName.includes('estudo')) {
                return "Caso de Estudo";
            } else if (lowerName.includes('opiniao') || lowerName.includes('smell')) {
                return "Opinião & Análise";
            } else if (lowerName.includes('comparativo') || lowerName.includes('vs') || lowerName.includes('ferramenta')) {
                return "Comparativos & Análise";
            } else if (lowerName.includes('futuro') || lowerName.includes('ia') || lowerName.includes('tendencia')) {
                return "Tendências & Futuro";
            } else if (lowerName.includes('gestao') || lowerName.includes('lider') || lowerName.includes('metricas')) {
                return "Gestão & Liderança";
            } else if (lowerName.includes('iniciante') || lowerName.includes('junior')) {
                return "Para Iniciantes";
            }
            
            return "Artigo Técnico";
        }
        
        // Função principal para carregar artigos
        async function loadArticles() {
            const articlesGrid = document.getElementById('articlesGrid');
            const articlesCount = document.getElementById('articlesCount');
            const noResults = document.getElementById('noResults');
            
            // Mostrar estado de carregamento
            articlesGrid.innerHTML = `
                <div style="grid-column: 1 / -1; text-align: center; padding: 2rem;">
                    <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: #3b82f6; margin-bottom: 1rem;"></i>
                    <p>Detectando artigos na pasta 'artigos/'...</p>
                </div>
            `;
            
            // 1. Detecta automaticamente os arquivos
            const articleFiles = await detectArticles();
            
            // 2. Cria array de artigos com metadados
            const articles = articleFiles.map(fileName => {
                // Usa metadados do mapa se existirem, senão gera automaticamente
                const metadata = ARTICLE_METADATA_MAP[fileName] || {
                    title: generateAutoTitle(fileName),
                    excerpt: `Artigo completo sobre ${generateAutoTitle(fileName).toLowerCase()}.`,
                    category: generateAutoCategory(fileName),
                    readTime: "5 min"
                };
                
                return {
                    file: fileName,
                    title: metadata.title,
                    excerpt: metadata.excerpt,
                    category: metadata.category,
                    date: generateAutoDate(fileName),
                    readTime: metadata.readTime
                };
            });
            
            // 3. Ordena por data (mais recente primeiro)
            articles.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            // 4. Renderiza os cards
            articlesGrid.innerHTML = '';
            articles.forEach(article => {
                articlesGrid.innerHTML += generateArticleCard(article);
            });
            
            // 5. Atualiza contador
            articlesCount.innerHTML = `
                <strong>${articles.length}</strong> artigos detectados automaticamente
                <small style="display: block; font-size: 0.8em; margin-top: 0.5rem;">
                    Última atualização: ${new Date().toLocaleTimeString('pt-BR')}
                </small>
            `;
            
            // 6. Configura busca
            setupSearch(articles);
        }
        
        // Função para gerar card (mantida do código anterior)
        function generateArticleCard(article) {
            return `
                <article class="article-card">
                    <span class="article-category">${article.category}</span>
                    <h2 class="article-title">${article.title}</h2>
                    <p class="article-excerpt">${article.excerpt}</p>
                    <div class="article-meta">
                        <div>
                            <span><i class="far fa-calendar"></i> ${article.date}</span>
                            <span style="margin-left: 1rem;" class="read-time">
                                <i class="far fa-clock"></i> ${article.readTime}
                            </span>
                        </div>
                        <a href="artigos/${article.file}" class="read-more-link">
                            Ler artigo <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </article>
            `;
        }
        
        // Função para configurar busca
        function setupSearch(articles) {
            const searchInput = document.getElementById('searchInput');
            const articlesCount = document.getElementById('articlesCount');
            const noResults = document.getElementById('noResults');
            
            searchInput.addEventListener('input', function(e) {
                const searchTerm = e.target.value.toLowerCase().trim();
                const articleCards = document.querySelectorAll('.article-card');
                
                let visibleCount = 0;
                
                articles.forEach((article, index) => {
                    const card = articleCards[index];
                    const matches = 
                        article.title.toLowerCase().includes(searchTerm) ||
                        article.excerpt.toLowerCase().includes(searchTerm) ||
                        article.category.toLowerCase().includes(searchTerm) ||
                        article.file.toLowerCase().includes(searchTerm);
                    
                    if (matches || searchTerm === '') {
                        card.style.display = 'block';
                        visibleCount++;
                    } else {
                        card.style.display = 'none';
                    }
                });
                
                // Atualiza contador
                articlesCount.innerHTML = `
                    <strong>${visibleCount}</strong> de ${articles.length} artigos correspondem
                    ${searchTerm ? `à busca por "${searchTerm}"` : ''}
                `;
                
                // Mostra/oculta mensagem de "sem resultados"
                if (visibleCount === 0 && searchTerm.length > 0) {
                    noResults.style.display = 'block';
                } else {
                    noResults.style.display = 'none';
                }
            });
        }
        
        // Sistema de tema (mantido)
        function setupThemeToggle() {
            const themeToggle = document.getElementById('themeToggle');
            const savedTheme = localStorage.getItem('theme') || 'dark';
            
            if (savedTheme === 'light') {
                document.body.classList.remove('dark-theme');
                document.body.classList.add('light-theme');
                themeToggle.querySelector('i').className = 'fas fa-sun';
            }
            
            themeToggle.addEventListener('click', function() {
                const isDark = document.body.classList.contains('dark-theme');
                
                if (isDark) {
                    document.body.classList.remove('dark-theme');
                    document.body.classList.add('light-theme');
                    this.querySelector('i').className = 'fas fa-sun';
                    localStorage.setItem('theme', 'light');
                } else {
                    document.body.classList.remove('light-theme');
                    document.body.classList.add('dark-theme');
                    this.querySelector('i').className = 'fas fa-moon';
                    localStorage.setItem('theme', 'dark');
                }
            });
        }

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            // Ano atual
            document.getElementById('currentYear').textContent = new Date().getFullYear();
            
            // Tema
            setupThemeToggle();
            
            // Carrega artigos automaticamente
            loadArticles();
            
            // Botão para forçar recarregamento
            const reloadBtn = document.createElement('button');
            reloadBtn.innerHTML = '<i class="fas fa-sync-alt"></i> Recarregar Artigos';
            reloadBtn.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                background: #3b82f6;
                color: white;
                border: none;
                padding: 0.5rem 1rem;
                border-radius: 20px;
                cursor: pointer;
                font-size: 0.8rem;
                z-index: 1000;
                box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            `;
            reloadBtn.onclick = () => {
                reloadBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Detectando...';
                setTimeout(() => {
                    loadArticles();
                    reloadBtn.innerHTML = '<i class="fas fa-sync-alt"></i> Recarregar Artigos';
                }, 500);
            };
            document.body.appendChild(reloadBtn);
        });
    </script>
</body>
</html>
